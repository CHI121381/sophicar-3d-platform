<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sophicar 3Dæ•°å­—äº¤äº’å¹³å°</title>
    <style>
      body {
        margin: 0;
        padding: 0;
        font-family: 'Microsoft YaHei', 'Orbitron', Arial, sans-serif;
        background: #0a0a0a;
        color: white;
        overflow: hidden;
      }
      
      /* åŠ è½½åŠ¨ç”»å®¹å™¨ */
      .loading-container {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #16213e 100%);
        z-index: 2000;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      
      .loading-3d {
        width: 100%;
        height: 100%;
        position: relative;
      }
      
      /* åŠ è½½æç¤ºæ–‡å­— */
      .loading-text {
        position: absolute;
        bottom: 10%;
        left: 50%;
        transform: translateX(-50%);
        text-align: center;
        z-index: 2001;
        opacity: 0;
        animation: fadeInOut 3s ease-in-out infinite;
      }
      
      .loading-text h2 {
        margin: 0 0 10px 0;
        font-size: 1.5em;
        color: #00ffff;
        text-shadow: 0 0 20px #00ffff;
        letter-spacing: 3px;
        font-weight: 300;
      }
      
      .loading-text p {
        margin: 0;
        color: #40e0d0;
        font-size: 1em;
        opacity: 0.8;
        letter-spacing: 1px;
      }
      
      /* è¿›åº¦æ¡ */
      .loading-progress {
        position: absolute;
        bottom: 5%;
        left: 50%;
        transform: translateX(-50%);
        width: 300px;
        height: 2px;
        background: rgba(0, 255, 255, 0.2);
        border-radius: 1px;
        overflow: hidden;
        z-index: 2001;
      }
      
      .loading-progress::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, #00ffff, transparent);
        animation: progressScan 2s ease-in-out infinite;
      }
      
      /* æ§åˆ¶é¢æ¿ */
      .controls {
        position: fixed;
        top: 20px;
        left: 20px;
        background: rgba(0, 20, 40, 0.9);
        padding: 15px;
        border-radius: 8px;
        border: 1px solid #00ffff;
        box-shadow: 0 0 20px rgba(0, 255, 255, 0.3);
        z-index: 100;
        font-size: 14px;
        backdrop-filter: blur(10px);
        display: none;
      }
      
      .controls h3 {
        margin: 0 0 10px 0;
        color: #00ffff;
        text-shadow: 0 0 10px #00ffff;
        font-weight: 300;
        letter-spacing: 1px;
      }
      
      .controls ul {
        margin: 0;
        padding-left: 20px;
        color: #40e0d0;
      }
      
      .controls li {
        margin-bottom: 5px;
        opacity: 0.9;
      }
      
      /* åŠ¨ç”»å…³é”®å¸§ */
      @keyframes fadeInOut {
        0%, 100% { opacity: 0; }
        50% { opacity: 1; }
      }
      
      @keyframes progressScan {
        0% { left: -100%; }
        100% { left: 100%; }
      }
      
      /* èµ›åšæœ‹å…‹ç½‘æ ¼èƒŒæ™¯ */
      .cyber-grid {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-image: 
          linear-gradient(rgba(0, 255, 255, 0.1) 1px, transparent 1px),
          linear-gradient(90deg, rgba(0, 255, 255, 0.1) 1px, transparent 1px);
        background-size: 50px 50px;
        animation: gridMove 20s linear infinite;
        z-index: 1;
        opacity: 0.3;
      }
      
      @keyframes gridMove {
        0% { transform: translate(0, 0); }
        100% { transform: translate(50px, 50px); }
      }
      
      /* éšè—ç±» */
      .hidden {
        display: none !important;
      }
      
      /* æ·¡å‡ºåŠ¨ç”» */
      .fade-out {
        animation: fadeOut 1s ease-out forwards;
      }
      
      @keyframes fadeOut {
        0% { opacity: 1; }
        100% { opacity: 0; }
      }

      /* GitHub Pages ç‰¹å®šæ ·å¼ */
      .github-info {
        position: fixed;
        top: 20px;
        right: 20px;
        background: rgba(0, 20, 40, 0.9);
        padding: 10px;
        border-radius: 8px;
        border: 1px solid #00ffff;
        box-shadow: 0 0 20px rgba(0, 255, 255, 0.3);
        z-index: 100;
        font-size: 12px;
        backdrop-filter: blur(10px);
        color: #40e0d0;
      }
    </style>
  </head>
  <body>
    <!-- èµ›åšæœ‹å…‹ç½‘æ ¼èƒŒæ™¯ -->
    <div class="cyber-grid"></div>
    
    <!-- GitHub Pages ä¿¡æ¯ -->
    <div class="github-info">
      <div>ğŸš€ GitHub Pages</div>
      <div>å®Œæ•´åŠŸèƒ½ç‰ˆæœ¬</div>
    </div>
    
    <!-- 3DåŠ è½½åŠ¨ç”»å®¹å™¨ -->
    <div class="loading-container" id="loadingContainer">
      <div class="loading-3d" id="loading3D"></div>
      
      <!-- åŠ è½½æç¤ºæ–‡å­— -->
      <div class="loading-text">
        <h2>SOPHICAR</h2>
        <p>3Dæ•°å­—äº¤äº’å¹³å°æ­£åœ¨å¯åŠ¨...</p>
      </div>
      
      <!-- è¿›åº¦æ¡ -->
      <div class="loading-progress"></div>
    </div>
    
    <!-- æ§åˆ¶é¢æ¿ -->
    <div class="controls" id="controls">
      <h3>æ“ä½œè¯´æ˜</h3>
      <ul>
        <li>é¼ æ ‡å·¦é”®æ‹–æ‹½ï¼šæ—‹è½¬è§†è§’</li>
        <li>é¼ æ ‡å³é”®æ‹–æ‹½ï¼šå¹³ç§»è§†è§’</li>
        <li>é¼ æ ‡æ»šè½®ï¼šç¼©æ”¾</li>
        <li>Ré”®ï¼šé‡ç½®ç›¸æœº</li>
        <li>Ié”®ï¼šæ‰“å¼€æ¨¡å‹å¯¼å…¥ç•Œé¢</li>
        <li>ESCé”®ï¼šå–æ¶ˆé€‰æ‹©</li>
        <li>ğŸš€ éš§é“é©¾é©¶æŒ‰é’®ï¼šä½“éªŒé©¾é©¶æ¨¡å¼</li>
      </ul>
    </div>
    
    <script type="module">
      // GitHub Pages ç‰¹å®šçš„æ¨¡å—åŠ è½½
      console.log('ğŸš€ å¼€å§‹åŠ è½½ GitHub Pages ç‰ˆæœ¬...');
      
      async function loadApplication() {
        try {
          console.log('ğŸ“¦ åŠ è½½ Three.js ä» CDN...');
          
          // ä½¿ç”¨CDNç‰ˆæœ¬çš„Three.js
          const THREE = await import('https://unpkg.com/three@0.182.0/build/three.module.js');
          window.THREE = THREE;
          console.log('âœ… Three.js åŠ è½½æˆåŠŸ');
          
          // åŠ è½½GitHubä¸“ç”¨ç‰ˆæœ¬
          console.log('ğŸ“± åŠ è½½GitHubä¸“ç”¨åº”ç”¨ç‰ˆæœ¬...');
          const { GitHubSophicarApp } = await import('./main-github.js');
          console.log('âœ… GitHubä¸“ç”¨ç‰ˆæœ¬åŠ è½½æˆåŠŸ');
          
          // å¯åŠ¨åº”ç”¨
          window.githubSophicarApp = new GitHubSophicarApp();
          
        } catch (error) {
          console.error('âŒ åº”ç”¨åŠ è½½å¤±è´¥:', error);
          
          // æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯å’Œå¤‡ç”¨é€‰é¡¹
          const loadingContainer = document.getElementById('loadingContainer');
          if (loadingContainer) {
            const errorHTML = [
              '<div style="text-align: center; color: #ff6666; padding: 40px;">',
              '<h2>âš ï¸ åº”ç”¨åŠ è½½å¤±è´¥</h2>',
              '<p>é”™è¯¯ä¿¡æ¯: ' + error.message + '</p>',
              '<div style="margin-top: 30px;">',
              '<button onclick="location.reload()" style="background: #00ffff; color: #000; border: none; padding: 12px 24px; border-radius: 5px; cursor: pointer; margin: 5px; font-size: 14px;">ğŸ”„ åˆ·æ–°é¡µé¢</button>',
              '<button onclick="window.open(\'./test-simple.html\', \'_self\')" style="background: #4CAF50; color: white; border: none; padding: 12px 24px; border-radius: 5px; cursor: pointer; margin: 5px; font-size: 14px;">ğŸ§ª æµ‹è¯•ç‰ˆæœ¬</button>',
              '</div>',
              '</div>'
            ].join('');
            loadingContainer.innerHTML = errorHTML;
          }
        }
      }
      
      // å¯åŠ¨åº”ç”¨åŠ è½½
      loadApplication();
    </script>
    <script>
      // å¢å¼ºçš„é”™è¯¯å¤„ç†å’Œè°ƒè¯•
      window.addEventListener('error', (event) => {
        console.error('å…¨å±€é”™è¯¯:', event.error);
        console.error('é”™è¯¯è¯¦æƒ…:', {
          message: event.message,
          filename: event.filename,
          lineno: event.lineno,
          colno: event.colno
        });
      });

      window.addEventListener('unhandledrejection', (event) => {
        console.error('æœªå¤„ç†çš„Promiseæ‹’ç»:', event.reason);
      });

      // ç›‘å¬åŠ è½½åŠ¨ç”»å®Œæˆäº‹ä»¶
      document.getElementById('loading3D').addEventListener('loadingAnimationComplete', () => {
        const loadingContainer = document.getElementById('loadingContainer');
        const controls = document.getElementById('controls');
        
        console.log('åŠ è½½åŠ¨ç”»å®Œæˆï¼Œå¼€å§‹éšè—åŠ è½½ç•Œé¢');
        
        // æ·»åŠ æ·¡å‡ºåŠ¨ç”»
        loadingContainer.classList.add('fade-out');
        
        // åŠ¨ç”»å®Œæˆåå®Œå…¨ç§»é™¤åŠ è½½ç•Œé¢å¹¶æ˜¾ç¤ºæ§åˆ¶é¢æ¿
        setTimeout(() => {
          // å®Œå…¨ç§»é™¤åŠ è½½å®¹å™¨ï¼Œè€Œä¸æ˜¯ä»…ä»…éšè—
          if (loadingContainer && loadingContainer.parentNode) {
            loadingContainer.parentNode.removeChild(loadingContainer);
            console.log('åŠ è½½å®¹å™¨å·²ç§»é™¤');
          }
          
          if (controls) {
            controls.style.display = 'block';
          }
          
          console.log('äº¤äº’ç•Œé¢å·²æ¿€æ´»');
        }, 1000);
      });
      
      // è¶…æ—¶ä¿æŠ¤ - å¦‚æœ15ç§’åä»åœ¨åŠ è½½ç•Œé¢ï¼Œå¼ºåˆ¶æ˜¾ç¤ºé”™è¯¯
      setTimeout(() => {
        const loadingContainer = document.getElementById('loadingContainer');
        if (loadingContainer && loadingContainer.style.display !== 'none') {
          console.error('GitHub Pages åŠ è½½è¶…æ—¶');
          
          // æ˜¾ç¤ºè¯¦ç»†é”™è¯¯ä¿¡æ¯
          const errorDiv = document.createElement('div');
          errorDiv.style.cssText = `
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255, 0, 0, 0.9);
            color: white;
            padding: 30px;
            border-radius: 10px;
            text-align: center;
            z-index: 9999;
            max-width: 500px;
            font-family: 'Microsoft YaHei', Arial, sans-serif;
          `;
          errorDiv.innerHTML = `
            <h3>âš ï¸ GitHub Pages åŠ è½½è¶…æ—¶</h3>
            <p>å¯èƒ½çš„åŸå› ï¼š</p>
            <ul style="text-align: left; margin: 15px 0;">
              <li>GitHub Pages éƒ¨ç½²å°šæœªå®Œæˆ</li>
              <li>æ¨¡å—è·¯å¾„é…ç½®é—®é¢˜</li>
              <li>ç½‘ç»œè¿æ¥é—®é¢˜</li>
            </ul>
            <p>è¯·å°è¯•ï¼š</p>
            <button onclick="location.reload()" style="
              background: #fff;
              color: #000;
              border: none;
              padding: 10px 20px;
              border-radius: 5px;
              cursor: pointer;
              margin: 5px;
              font-size: 14px;
            ">åˆ·æ–°é¡µé¢</button>
            <button onclick="window.open('https://github.com/CHI121381/sophicar-3d-platform', '_blank')" style="
              background: #4CAF50;
              color: white;
              border: none;
              padding: 10px 20px;
              border-radius: 5px;
              cursor: pointer;
              margin: 5px;
              font-size: 14px;
            ">æŸ¥çœ‹æºç </button>
          `;
          document.body.appendChild(errorDiv);
        }
      }, 15000);
      
      // å¤„ç†çª—å£å¤§å°å˜åŒ–
      window.addEventListener('resize', () => {
        if (window.loadingAnimation) {
          window.loadingAnimation.handleResize();
        }
        if (window.sophicarApp) {
          window.sophicarApp.getSceneManager().handleResize();
        }
      });
    </script>
  </body>
</html>